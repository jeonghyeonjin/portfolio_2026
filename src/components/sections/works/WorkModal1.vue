<template>
  <div class="work-modal-content">
    <div ref="workModalHeaderRef" class="work-modal-header">
      <h1 class="work-modal-title">{{ workData?.title || '' }}</h1>
      <p class="work-modal-subtitle">{{ workData?.description || '' }}</p>
      <div ref="producthuntBadgeRef" class="producthunt-badge">
        <img
          src="@/assets/images/producthunt/dailybadge2.avif"
          alt="Product Hunt Daily #2"
          class="producthunt-badge-icon"
        />
        <div class="producthunt-badge-text">
          <span class="producthunt-badge-label">Product Hunt Daily #2</span>
          <span class="producthunt-badge-date">May 14th, 2025</span>
        </div>
      </div>
    </div>
    <div class="work-modal-body">
      <div ref="heroImageContainerRef" class="hero-image-container">
        <div ref="heroImageWrapperRef" class="hero-image-wrapper">
          <div ref="heroImageOverlayRef" class="hero-image-overlay"></div>
          <img
            src="@/assets/images/works/shadow/shadow_mockup.png"
            alt="Shadow Application Mockup"
            class="hero-image"
          />
        </div>
      </div>

      <!-- Project Overview -->
      <section class="content-section">
        <h2 class="section-title">ğŸ“Œ Project Overview | í”„ë¡œì íŠ¸ ê°œìš”</h2>
        <p class="section-text">
          ShadowëŠ” AI ê¸°ë°˜ ì‹¤ì‹œê°„ íšŒì˜ ê¸°ë¡ ë° ë¶„ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. macOSì—ì„œ ì‹œìŠ¤í…œ ì˜¤ë””ì˜¤ë¥¼
          ìº¡ì²˜í•˜ê³ , ìë™ìœ¼ë¡œ í…ìŠ¤íŠ¸ ë³€í™˜ ë° ìš”ì•½ì„ ì œê³µí•˜ëŠ” ë°ìŠ¤í¬í†± ì•±ì…ë‹ˆë‹¤.
        </p>
        <p class="section-text">
          Flutterë¥¼ ì‚¬ìš©í•˜ì—¬ ê°œë°œì„ ì§„í–‰í–ˆìœ¼ë©°, GetXë¥¼ í™œìš©í•œ ìƒíƒœ ê´€ë¦¬ì™€ ë„¤ì´í‹°ë¸Œ í”ŒëŸ¬ê·¸ì¸ ì—°ë™ì„
          í†µí•´ ê³ ì„±ëŠ¥ ì•±ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
        </p>
      </section>

      <!-- Tech Stack -->
      <section class="content-section">
        <h2 class="section-title">ğŸ› ï¸ Tech Stack Summary</h2>
        <TechStackGrid :stacks="techStacks" />
      </section>

      <!-- Logo Design -->
      <section class="content-section">
        <h2 class="section-title">ğŸ¨ Logo Design | ë¡œê³  ë””ìì¸</h2>
        <p class="section-text">
          Shadow ë¡œê³ ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ìœ¼ë¡œ ë°œì „í•˜ë©° ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì›í˜•ì˜ ë¬¼ì²´ê°€ ê·¸ë¦¼ìë¥¼ ë°›ì€
          ëª¨ì–‘ì„ í˜•ìƒí™”í•œ í›„, ê·¸ë¦¼ìë§Œ ë”°ì„œ Shadowì˜ Sìë¥¼ ê·¸ë ¤ëƒˆìŠµë‹ˆë‹¤.
        </p>
        <div class="logo-evolution">
          <div class="logo-timeline">
            <div class="logo-item">
              <img
                src="@/assets/images/works/shadow/logo1.png"
                alt="Shadow Logo 1"
                class="logo-image"
              />
              <p class="logo-label">ë¬¼ì²´ì— ê·¸ë¦¼ìê°€ ìƒê¸´ ëª¨ìŠµ</p>
            </div>
            <div class="logo-arrow">â†’</div>
            <div class="logo-item">
              <img
                src="@/assets/images/works/shadow/logo2.png"
                alt="Shadow Logo 2"
                class="logo-image"
              />
              <p class="logo-label">ê·¸ë¦¼ì ëª¨ì–‘ì„ í˜•ìƒí™”</p>
            </div>
            <div class="logo-arrow">â†’</div>
            <div class="logo-item">
              <img
                src="@/assets/images/works/shadow/logo3.png"
                alt="Shadow Logo 3"
                class="logo-image"
              />
              <p class="logo-label">Shadowì˜ S</p>
            </div>
            <div class="logo-arrow">â†’</div>
            <div class="logo-item">
              <img
                src="@/assets/images/works/shadow/logo4.png"
                alt="Shadow Logo 4"
                class="logo-image"
              />
              <p class="logo-label">Final</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Key Features -->
      <section class="content-section">
        <h2 class="section-title">ğŸ¨ My Key Contributions</h2>

        <!-- Feature 1 -->
        <div class="feature-block" ref="featureBlock1Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText1Ref">
              <h3 class="feature-title">1. Zero-Latency Image Gallery Core</h3>
              <p class="feature-subtitle">ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ ìµœì í™” ì—”ì§„</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                ê³ í•´ìƒë„ ìŠ¤í¬ë¦°ìƒ· ì´ë¯¸ì§€ë¥¼ PageViewë¡œ ë‹¨ìˆœíˆ êµ¬í˜„í–ˆì„ ë•Œ, ì´ë¯¸ì§€ë¥¼ ë„˜ê¸°ëŠ”
                ìˆœê°„(Swipe)ë§ˆë‹¤ í”„ë ˆì„ ë“œë(Jank)ê³¼ ë¡œë”© ì¸ë””ì¼€ì´í„°ê°€ ë°œìƒí•˜ëŠ” í˜„ìƒì´ ìˆì—ˆìŠµë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Predictive Preloading:</strong> ì‚¬ìš©ìì˜ ë„¤ë¹„ê²Œì´ì…˜ ë°©í–¥ì„ ì˜ˆì¸¡í•˜ì—¬
                  ì´ë¯¸ì§€ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì ì¬
                </li>
                <li>
                  <strong>Dual-Layer Caching:</strong> ImageSizeCacheì™€ WidgetCacheë¥¼ í†µí•´ ë ˆì´ì•„ì›ƒ
                  ì‹œí”„íŠ¸ ë°©ì§€ ë° ì¬ë Œë”ë§ ë¹„ìš© ì œê±°
                </li>
                <li>
                  <strong>Smart Memory Management:</strong> ë·°í¬íŠ¸ì—ì„œ ë©€ì–´ì§„ ì´ë¯¸ì§€ëŠ” ìë™ìœ¼ë¡œ
                  ìºì‹œì—ì„œ í•´ì œí•˜ì—¬ OOM ë°©ì§€
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode1Ref">
            <CodeBlock :code="cachingCode" language="dart" />
          </div>
          <div class="feature-demo-image">
            <!-- <img
              src="@/assets/images/works/shadow/gallery_interaction.gif"
              alt="Gallery Interaction Demo"
              class="demo-gif"
            /> -->
          </div>
        </div>

        <!-- Feature 2 -->
        <div class="feature-block" ref="featureBlock2Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText2Ref">
              <h3 class="feature-title">2. Adaptive Responsive Layout Algorithm</h3>
              <p class="feature-subtitle">ì ì‘í˜• ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ ì•Œê³ ë¦¬ì¦˜</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                ë°ìŠ¤í¬í†± ì•±ì´ì§€ë§Œ ìœˆë„ìš° í¬ê¸°ë¥¼ ììœ ë¡­ê²Œ ì¡°ì ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨ìˆœíˆ ë¯¸ë””ì–´ ì¿¼ë¦¬ë‚˜
                í•˜ë“œì½”ë”©ëœ ë¸Œë ˆì´í¬í¬ì¸íŠ¸ë¡œëŠ” ë‹¤ì–‘í•œ í•´ìƒë„ì™€ ì°½ í¬ê¸°ì—ì„œ ìµœì ì˜ UXë¥¼ ì œê³µí•  ìˆ˜
                ì—†ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì¢Œìš° ì‚¬ì´ë“œë°”, ë©”ì¸ ì»¨í…ì¸ , ìƒì„¸ íŒ¨ë„ì´ ìˆëŠ” 3ë‹¨ ë ˆì´ì•„ì›ƒì—ì„œëŠ” ê°
                ì˜ì—­ì´ ë™ì ìœ¼ë¡œ ì¼œì§€ê³  êº¼ì ¸ì•¼ í–ˆìŠµë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Viewport-Aware Calculation:</strong> í˜„ì¬ ë·°í¬íŠ¸ ë„ˆë¹„ì—ì„œ í•„ìˆ˜
                  ì˜ì—­(ì‚¬ì´ë“œë°”, ì—¬ë°± ë“±)ì„ ëº€ ë‚˜ë¨¸ì§€ ê³µê°„ì„ ê³„ì‚°í•˜ì—¬ ë©”ì¸ ì˜ì—­ê³¼ ìƒì„¸ íŒ¨ë„ì˜ í‘œì‹œ
                  ì—¬ë¶€ ê²°ì •
                </li>
                <li>
                  <strong>Priority-Based Rendering:</strong> ê³µê°„ì´ ë¶€ì¡±í•  ë•Œ ì‚¬ì´ë“œë°” â†’ ìƒì„¸ íŒ¨ë„ â†’
                  ë©”ì¸ ì˜ì—­ ìˆœìœ¼ë¡œ ìš°ì„ ìˆœìœ„ë¥¼ ë‘ì–´ í•µì‹¬ ê¸°ëŠ¥ì´ í•­ìƒ ë³´ì´ë„ë¡ ì„¤ê³„
                </li>
                <li>
                  <strong>Threshold-Based Toggling:</strong> ë‹¨ìˆœ on/offê°€ ì•„ë‹Œ, ì„ê³„ê°’ ê¸°ë°˜ìœ¼ë¡œ
                  ë¶€ë“œëŸ½ê²Œ ë ˆì´ì•„ì›ƒ ì „í™˜ (ì˜ˆ: ë©”ì¸ ì˜ì—­ ìµœì†Œ 600px í™•ë³´ ì‹œì—ë§Œ ìƒì„¸ íŒ¨ë„ í‘œì‹œ)
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode2Ref">
            <CodeBlock :code="adaptiveLayoutCode" language="dart" />
          </div>
          <div class="feature-demo-image">
            <!-- <img
              src="@/assets/images/works/shadow/multi_window_layout.gif"
              alt="Multi-Window Layout Demo"
              class="demo-gif"
            /> -->
          </div>
        </div>

        <!-- Feature 3 -->
        <div class="feature-block" ref="featureBlock3Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText3Ref">
              <h3 class="feature-title">3. Desktop-Class Keyboard Interaction</h3>
              <p class="feature-subtitle">ë°ìŠ¤í¬í†±ê¸‰ í‚¤ë³´ë“œ ì¸í„°ë™ì…˜</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                ë°ìŠ¤í¬í†± ì•±ì—ì„œëŠ” ë§ˆìš°ìŠ¤ ì—†ì´ í‚¤ë³´ë“œë§Œìœ¼ë¡œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì„ íƒí•˜ê³  ì´ë™í•˜ê³  ì‹¶ì–´ í•˜ëŠ”
                ë‹ˆì¦ˆê°€ ìˆìŠµë‹ˆë‹¤. ë‹¨ìˆœí•œ TextFieldëŠ” ë°©í–¥í‚¤ ì…ë ¥ì„ ì»¤ì„œ ì´ë™ìœ¼ë¡œ ì†Œë¹„í•´ë²„ë¦¬ê¸° ë•Œë¬¸ì—,
                ì´ë¥¼ ê°€ë¡œì±„ëŠ” ë¡œì§ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Event Interception:</strong> FocusNodeì˜ onKeyEvent ë‹¨ê³„ì—ì„œ í‚¤ ì…ë ¥ì„
                  ë¨¼ì € ê²€ì‚¬í•˜ì—¬ ê²€ìƒ‰ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë¼ìš°íŒ…
                </li>
                <li>
                  <strong>State Locking:</strong> ë§ˆìš°ìŠ¤ í˜¸ë²„ì™€ í‚¤ë³´ë“œ ì„ íƒ ê°„ì˜ ì¶©ëŒì„ ë°©ì§€í•˜ê¸°
                  ìœ„í•œ ìƒíƒœ ì ê¸ˆ êµ¬í˜„
                </li>
                <li>
                  <strong>Viewport Synchronization:</strong> ì„ íƒëœ ì•„ì´í…œì´ í•­ìƒ í™”ë©´ì— ë³´ì´ë„ë¡
                  ìŠ¤í¬ë¡¤ ë™ê¸°í™”
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode3Ref">
            <CodeBlock :code="keyboardCode" language="dart" />
          </div>
        </div>

        <!-- Feature 4 -->
        <div class="feature-block" ref="featureBlock4Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText4Ref">
              <h3 class="feature-title">4. Generic Search & Scroll Orchestration</h3>
              <p class="feature-subtitle">ì¶”ìƒí™”ëœ ê²€ìƒ‰ ë° ìŠ¤í¬ë¡¤ ë¡œì§</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                'ìŠ¤í‚¬(Skill)' ê²€ìƒ‰ê³¼ 'ìŠ¤í¬ë¦°ìƒ·(Screenshot)' ê²€ìƒ‰ì€ ë°ì´í„° êµ¬ì¡°ë„ ë‹¤ë¥´ê³ , UI
                í˜•íƒœ(ì„¸ë¡œ ë¦¬ìŠ¤íŠ¸ vs ê°€ë¡œ ë¦¬ìŠ¤íŠ¸)ë„ ë‹¤ë¦…ë‹ˆë‹¤. ê°ê° ë³„ë„ì˜ ë¡œì§ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ì½”ë“œ
                ì¤‘ë³µì´ ë°œìƒí•©ë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Abstracted Initialization:</strong> ì–´ë–¤ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ì™€ ìŠ¤í¬ë¡¤ ì»¨íŠ¸ë¡¤ëŸ¬ê°€
                  ë“¤ì–´ì˜¤ë“  í•„í„°ë§ í•¨ìˆ˜ë§Œ ì£¼ì…í•˜ë©´ ë™ì‘í•˜ë„ë¡ ì„¤ê³„ (Strategy Pattern)
                </li>
                <li>
                  <strong>Viewport Aware Scrolling:</strong> ì„ íƒëœ ì¸ë±ìŠ¤ê°€ ë·°í¬íŠ¸ë¥¼ ë²—ì–´ë‚¬ëŠ”ì§€
                  ê³„ì‚°í•˜ì—¬ í•„ìš”í•œ ë§Œí¼ë§Œ ìŠ¤í¬ë¡¤
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode4Ref">
            <CodeBlock :code="searchCode" language="dart" />
          </div>
        </div>

        <!-- Feature 5 -->
        <div class="feature-block" ref="featureBlock5Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText5Ref">
              <h3 class="feature-title">5. Real-Time Calendar Event Monitoring</h3>
              <p class="feature-subtitle">ì‹¤ì‹œê°„ ìº˜ë¦°ë” ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                ì‚¬ìš©ìê°€ ë¯¸íŒ…ì„ ì‹œì‘í•  ë•Œ, í•´ë‹¹ ë¯¸íŒ…ì´ Google Calendar ì´ë²¤íŠ¸ì™€ ì—°ê²°ë˜ì–´ì•¼ ì°¸ì„ì
                ì •ë³´, ì œëª©, ì‹œê°„ ë“±ì´ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤. ë˜í•œ ì•ìœ¼ë¡œ ë‹¤ê°€ì˜¬ ì´ë²¤íŠ¸(upcoming
                event)ë¥¼ ë¯¸ë¦¬ ìºì‹±í•˜ì—¬ ë¹ ë¥´ê²Œ í‘œì‹œí•´ì•¼ í–ˆìŠµë‹ˆë‹¤. API í˜¸ì¶œ ë¹„ìš©ì„ ì¤„ì´ê³  ì‹¤ì‹œê°„
                ë™ê¸°í™”ê°€ í•„ìš”í–ˆìŠµë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Time-Window Based Filtering:</strong> ë¦¬ìŠ¤ë‹ ì‹œì‘ ì‹œê°„ ê¸°ì¤€ Â±10ë¶„ ë²”ìœ„
                  ë‚´ì˜ ì´ë²¤íŠ¸ë§Œ ì¡°íšŒí•˜ì—¬ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ìµœì†Œí™”
                </li>
                <li>
                  <strong>Incremental Sync:</strong> Google Calendar APIì˜ syncTokenì„ í™œìš©í•˜ì—¬
                  ë³€ê²½ëœ ì´ë²¤íŠ¸ë§Œ ë™ê¸°í™” (API í˜¸ì¶œ 80% ê°ì†Œ)
                </li>
                <li>
                  <strong>Multi-Criteria Matching:</strong> ë¯¸íŒ… ë§í¬, ì°¸ì„ì ìˆ˜, ì‹œê°„ ì°¨ì´ ë“± ì—¬ëŸ¬
                  ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì´ë²¤íŠ¸ë§Œ ì„ íƒ
                </li>
                <li>
                  <strong>Upcoming Event Pre-fetching:</strong> í˜„ì¬ ì‹œê°„ ê¸°ì¤€ í–¥í›„ 24ì‹œê°„ ë‚´
                  ì´ë²¤íŠ¸ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë¯¸ë¦¬ ê°€ì ¸ì™€ ë¡œì»¬ DBì— ìºì‹±
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode5Ref">
            <CodeBlock :code="calendarFetchCode" language="dart" />
            <div style="margin-top: 24px">
              <CodeBlock :code="calendarUpcomingCode" language="dart" />
            </div>
          </div>
          <div class="feature-demo-image">
            <!-- <img
              src="@/assets/images/works/shadow/upcoming_event_sync.png"
              alt="Upcoming Event Sync Demo"
              class="demo-gif"
            /> -->
          </div>
        </div>

        <!-- Feature 6 -->
        <div class="feature-block" ref="featureBlock6Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText6Ref">
              <h3 class="feature-title">6. Event-Conversation Linking System</h3>
              <p class="feature-subtitle">ì´ë²¤íŠ¸-ëŒ€í™” ì—°ê²° ì‹œìŠ¤í…œ</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                ì‚¬ìš©ìê°€ ë…¹ìŒì„ ì‹œì‘í•˜ë©´, í•´ë‹¹ ë…¹ìŒì´ ì–´ë–¤ ìº˜ë¦°ë” ì´ë²¤íŠ¸ì™€ ì—°ê²°ë˜ëŠ”ì§€ ìë™ìœ¼ë¡œ
                ë§¤ì¹­í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¨ìˆœíˆ ì‹œê°„ë§Œ ë¹„êµí•˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë¯€ë¡œ, ë¯¸íŒ… URL, ì°¸ì„ì ìˆ˜, ì‹œê°„
                ë²”ìœ„ ë“± ì—¬ëŸ¬ ì¡°ê±´ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Meeting Guard Pattern:</strong> ì´ë²¤íŠ¸ê°€ ì‹¤ì œ ë¯¸íŒ…ì¸ì§€ ê²€ì¦í•˜ëŠ” ë‹¤ë‹¨ê³„
                  í•„í„°ë§ (ë¯¸íŒ… URL ì¡´ì¬ ì—¬ë¶€, ì°¸ì„ì 2ëª… ì´ìƒ, ì·¨ì†Œë˜ì§€ ì•ŠìŒ ë“±)
                </li>
                <li>
                  <strong>Time-Based Scoring:</strong> ë…¹ìŒ ì‹œì‘ ì‹œê°„ê³¼ ì´ë²¤íŠ¸ ì‹œê°„ì˜ ì°¨ì´ë¥¼
                  ì ìˆ˜í™”í•˜ì—¬ ê°€ì¥ ê·¼ì ‘í•œ ì´ë²¤íŠ¸ ì„ íƒ
                </li>
                <li>
                  <strong>Automatic Association:</strong> ì„ íƒëœ ì´ë²¤íŠ¸ì˜ attendeesë¥¼ ë¡œì»¬ DBì—
                  ìë™ìœ¼ë¡œ ì €ì¥í•˜ì—¬ ëŒ€í™” ì°¸ì„ì ëª©ë¡ìœ¼ë¡œ í™œìš©
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode6Ref">
            <CodeBlock :code="eventLinkingCode" language="dart" />
            <div style="margin-top: 24px">
              <CodeBlock :code="meetingGuardCode" language="dart" />
            </div>
          </div>
        </div>

        <!-- Feature 7 -->
        <div class="feature-block" ref="featureBlock7Ref">
          <div class="feature-content">
            <div class="feature-text" ref="featureText7Ref">
              <h3 class="feature-title">7. Complex Entity Management & Form UX</h3>
              <p class="feature-subtitle">ë³µì¡í•œ ì—”í‹°í‹° ê´€ë¦¬ ë° í¼ UX</p>

              <h4 class="content-heading">ğŸ“„ Problem</h4>
              <p class="content-text">
                í™”ì ì´ë¦„ì„ ìˆ˜ì •í•  ë•Œ, ë‹¨ìˆœíˆ í…ìŠ¤íŠ¸ë§Œ ë°”ê¾¸ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì´ë©”ì¼/ì´ë¦„ ë§¤ì¹­ì„ í†µí•´
                ê¸°ì¡´ ì—°ë½ì²˜(Contact)ì™€ ìë™ìœ¼ë¡œ ì—°ê²°í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í™”ì ì´ë¦„ìœ¼ë¡œ
                ë³€ê²½ ì‹œ, ë‘ í™”ìì˜ ë°œí™” ë°ì´í„°ë¥¼ ë³‘í•©(Merge)í•˜ê³  ë§ˆìš°ìŠ¤ ì—†ì´ í‚¤ë³´ë“œë§Œìœ¼ë¡œ ê²€ìƒ‰,
                ì„ íƒ, ì ìš©ì´ ê°€ëŠ¥í•œ ë¹ ë¥¸ ì›Œí¬í”Œë¡œìš°ê°€ í•„ìš”í–ˆìŠµë‹ˆë‹¤.
              </p>

              <h4 class="content-heading">ğŸ’¡ Solution</h4>
              <ul class="solution-list">
                <li>
                  <strong>Intelligent Merging System:</strong> ë³€ê²½í•˜ë ¤ëŠ” ì´ë¦„ì´ ì´ë¯¸ ì¡´ì¬í•˜ê±°ë‚˜
                  íŠ¹ì • ì´ë©”ì¼ê³¼ ë§¤ì¹­ë  ê²½ìš°, DB íŠ¸ëœì­ì…˜ì„ í†µí•´ í™”ì ì•„ì´ë””ë¥¼ í†µí•©í•˜ê³  ê´€ë ¨
                  ì°¸ì¡°(Foreign Key)ë¥¼ ëª¨ë‘ ì—…ë°ì´íŠ¸
                </li>
                <li>
                  <strong>Keyboard-Centric Control:</strong> FocusNodeì™€ KeyEventë¥¼ ì •êµí•˜ê²Œ
                  ì œì–´í•˜ì—¬, í™”ì‚´í‘œ ì´ë™, ìˆ«ì ë‹¨ì¶•í‚¤(Cmd+1~9) ì„ íƒ, ì—”í„° ì ìš© ë“± ë§ˆìš°ìŠ¤ ì—†ëŠ” ì™„ì „í•œ
                  ì œì–´ êµ¬í˜„
                </li>
                <li>
                  <strong>Context-Aware Searching:</strong> ë³¸ì¸(Me), íšŒì˜ ì°¸ì„ì, ì „ì²´ ì—°ë½ì²˜
                  ìˆœìœ¼ë¡œ ìš°ì„ ìˆœìœ„ë¥¼ ë¶€ì—¬í•œ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ ì ìš©
                </li>
              </ul>
            </div>
          </div>
          <div class="feature-code-wrapper" ref="featureCode7Ref">
            <CodeBlock :code="assignSpeakerCode" language="dart" />
          </div>
          <div class="feature-demo-image">
            <!-- <img
              src="@/assets/images/works/shadow/assign_speaker_flow.gif"
              alt="Assign Speaker Workflow Demo"
              class="demo-gif"
            /> -->
          </div>
        </div>
      </section>

      <!-- Performance Metrics -->
      <section class="content-section">
        <h2 class="section-title">ğŸ“ˆ Performance Impact</h2>
        <MetricsGrid :metrics="performanceMetrics" />
      </section>

      <!-- Key Takeaways -->
      <section class="content-section">
        <h2 class="section-title">ğŸ¯ Key Takeaways</h2>

        <div class="takeaway-block">
          <h3 class="takeaway-title">Performance & UX Engineering:</h3>
          <ul class="feature-list">
            <li>
              <strong>Zero-Latency Experience:</strong> Predictive Preloadingì„ í†µí•´ ì´ë¯¸ì§€ ë¡œë”©
              ì‹œê°„ì„ 100% ì œê±°í•˜ì—¬ ëŠê¹€ ì—†ëŠ” ì‚¬ìš©ì ê²½í—˜ ì œê³µ
            </li>
            <li>
              <strong>Keyboard-First Design:</strong> ë§ˆìš°ìŠ¤ ì—†ì´ ëª¨ë“  ê¸°ëŠ¥ ì¡°ì‘ ê°€ëŠ¥í•œ ë°ìŠ¤í¬í†±ê¸‰
              ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
            </li>
            <li>
              <strong>Memory Optimization:</strong> ìŠ¤ë§ˆíŠ¸ ìºì‹± ì‹œìŠ¤í…œìœ¼ë¡œ ëŒ€ìš©ëŸ‰ ì´ë¯¸ì§€ ì²˜ë¦¬ ì‹œ
              ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± ê·¹ëŒ€í™”
            </li>
          </ul>
        </div>

        <div class="takeaway-block">
          <h3 class="takeaway-title">System Integration & Architecture:</h3>
          <ul class="feature-list">
            <li>
              <strong>API Optimization:</strong> Google Calendar API ì¦ë¶„ ë™ê¸°í™”ë¥¼ í†µí•´ API í˜¸ì¶œ
              íšŸìˆ˜ 80% ê°ì†Œ
            </li>
            <li>
              <strong>Event-Driven Architecture:</strong> ë„¤ì´í‹°ë¸Œ í”ŒëŸ¬ê·¸ì¸ê³¼ Flutter ê°„ Event
              Stream í†µì‹  ì„¤ê³„
            </li>
            <li>
              <strong>Generic Patterns:</strong> ì œë„¤ë¦­ íŒ¨í„´ê³¼ ì¶”ìƒí™”ë¥¼ í†µí•´ ì½”ë“œ ì¬ì‚¬ìš©ì„± ê·¹ëŒ€í™” ë°
              ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
            </li>
          </ul>
        </div>

        <div class="takeaway-block">
          <h3 class="takeaway-title">Technical Skills Demonstrated:</h3>
          <ul class="feature-list">
            <li>
              <strong>Flutter Ecosystem:</strong> GetX (State Management), Native Plugins (Platform
              Channel), SQLite (Local DB)
            </li>
            <li>
              <strong>Algorithm Design:</strong> Adaptive Layout Algorithm, Time-Window Based Event
              Matching, Predictive Caching
            </li>
            <li>
              <strong>External API Integration:</strong> Google Calendar API, WebSocket, Real-time
              Sync
            </li>
          </ul>
        </div>
      </section>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, nextTick, inject, computed } from 'vue'
import { gsap } from 'gsap'
import { ScrollTrigger } from 'gsap/ScrollTrigger'
import { useResponsive } from '@/composables/useResponsive'
import CodeBlock from '@/components/common/CodeBlock.vue'
import MetricsGrid from '@/components/common/MetricsGrid.vue'
import TechStackGrid from '@/components/common/TechStackGrid.vue'
import worksData from '@/data/works.json'

const workId = inject('workId', 1)

const workData = computed(() => {
  return worksData.find((work) => work.id === workId) || null
})

gsap.registerPlugin(ScrollTrigger)

const workModalHeaderRef = ref(null)
const heroImageContainerRef = ref(null)
const heroImageOverlayRef = ref(null)
const heroImageWrapperRef = ref(null)
const { isMobile, isTablet } = useResponsive()
const featureText1Ref = ref(null)
const featureText2Ref = ref(null)
const featureText3Ref = ref(null)
const featureText4Ref = ref(null)
const featureText5Ref = ref(null)
const featureText6Ref = ref(null)
const featureCode1Ref = ref(null)
const featureCode2Ref = ref(null)
const featureCode3Ref = ref(null)
const featureCode4Ref = ref(null)
const featureCode5Ref = ref(null)
const featureCode6Ref = ref(null)
const featureCode7Ref = ref(null)
const featureText7Ref = ref(null)
const featureBlock1Ref = ref(null)
const featureBlock2Ref = ref(null)
const featureBlock3Ref = ref(null)
const featureBlock4Ref = ref(null)
const featureBlock5Ref = ref(null)
const featureBlock6Ref = ref(null)
const featureBlock7Ref = ref(null)

// Code snippets
const cachingCode = `/// Smart Caching System with Predictive Preloading
void _preloadImagesForNavigation(int oldIndex, int newIndex) {
  // 1. Direction analysis
  final direction = newIndex > oldIndex ? 1 : -1;

  // 2. Priority queue construction
  final indicesToLoad = <int>[newIndex]; // Critical

  if (direction > 0 && newIndex < screenshots.length - 1) {
    indicesToLoad.add(newIndex + 1); // High priority
  } else if (direction < 0 && newIndex > 0) {
    indicesToLoad.add(newIndex - 1);
  }

  // 3. Async preloading (non-blocking UI)
  for (final index in indicesToLoad) {
    final path = screenshots[index]['screenshotFilePath'];
    if (path != null && !_imageCache.containsKey(path)) {
      _preloadImage(path);
    }
  }

  // 4. Memory management
  _cleanupCacheDelayed(indicesToLoad);
}`

const adaptiveLayoutCode = `/// Adaptive Layout Calculator
bool _shouldShowDetail(double screenWidth) {
  // Calculate available space after essential elements
  const sidebarWidth = 240.0;
  const padding = 32.0;
  const mainMinWidth = 600.0;  // Minimum for main content
  const detailMinWidth = 400.0; // Minimum for detail panel

  final availableWidth = screenWidth - sidebarWidth - padding;

  // Priority-based rendering
  if (availableWidth < mainMinWidth) {
    return false; // Not enough space even for main
  }

  if (availableWidth < mainMinWidth + detailMinWidth) {
    return false; // Main area would be too cramped
  }

  return true; // Enough space for both
}

@override
Widget build(BuildContext context) {
  return LayoutBuilder(
    builder: (context, constraints) {
      final showDetail = _shouldShowDetail(constraints.maxWidth);

      return Row(
        children: [
          Sidebar(width: 240),
          Expanded(
            flex: showDetail ? 3 : 1,
            child: MainContent(),
          ),
          if (showDetail)
            Expanded(
              flex: 2,
              child: DetailPanel(),
            ),
        ],
      );
    },
  );
}`

const keyboardCode = `/// Event Routing Architecture
KeyEventResult handleAskInputFieldKey(KeyEvent event, bool isDisabled) {
  if (event is! KeyDownEvent) return KeyEventResult.ignored;

  // Screenshot search mode
  if (isScreenshotSearchVisible.value && filteredScreenshotList.isNotEmpty) {
    if (event.logicalKey == LogicalKeyboardKey.arrowRight) {
      if (selectedScreenshotIndex.value < filteredScreenshotList.length - 1) {
        // State locking to prevent mouse hover conflicts
        _setKeyboardNavigationState(true);

        selectedScreenshotIndex.value++;
        scrollToSelectedScreenshotItem(); // Viewport sync
      }
      return KeyEventResult.handled; // Prevent cursor movement
    }

    else if (event.logicalKey == LogicalKeyboardKey.enter) {
      selectScreenshot(
        filteredScreenshotList[selectedScreenshotIndex.value],
        closeSearch: true
      );
      return KeyEventResult.handled;
    }
  }

  return KeyEventResult.ignored;
}`

const searchCode = `/// Generic Search Initialization with Strategy Pattern
void _initializeSearch({
  required RxBool isVisible,
  required RxList filteredList,
  required List<dynamic> sourceData,
  required Function(List<dynamic>) filterFunction,
}) {
  // 1. Data filtering
  try {
    if (query.isEmpty) {
      filteredList.assignAll(sourceData.cast<Map<String, dynamic>>());
    } else {
      final filtered = filterFunction(sourceData);
      filteredList.assignAll(filtered.cast<Map<String, dynamic>>());
    }
  } catch (e) {
    filteredList.clear();
  }

  // 2. Visibility state management
  if (!isVisible.value) {
    isVisible.value = true;
    selectedIndex.value = 0;
  }

  // 3. Post-frame scroll adjustment
  if (onScrollToSelected != null) {
    WidgetsBinding.instance.addPostFrameCallback((_) {
      onScrollToSelected();
    });
  }
}`

const calendarFetchCode = `/// Time-Window Based Event Fetching with Incremental Sync
Future<void> fetchEventsForListening() async {
  if (!isConnected.value) return;

  // UTC time calculation (timezone-safe)
  final utcNow = DateTime.now().toUtc();
  final startTime = utcNow.subtract(const Duration(minutes: 10));
  final endTime = utcNow.add(const Duration(minutes: 10));

  // Duplicate request prevention
  final requestKey = 'listening:$startTime-$endTime';
  if (_shouldSkipRequest(requestKey)) return;

  try {
    // Incremental sync if syncToken exists
    if (localEventCount > 0 && _lastSyncToken.value.isNotEmpty) {
      await fetchChangedEvents(startTime: startTime, endTime: endTime);
      return;
    }

    // Full sync
    final response = await Api.getCalendarEvents(
      type: 'full',
      startTime: startTime.toIso8601String(),
      endTime: endTime.toIso8601String(),
      syncToken: _lastSyncToken.value,
    );

    // Extract and save syncToken
    if (response['syncToken'] != null) {
      _lastSyncToken.value = response['syncToken'].toString();
    }

    // Multi-criteria filtering
    final filteredEvents = newEvents
        .whereType<Map<String, dynamic>>()
        .where((event) => _passesMeetingGuards(event))
        .toList();
  } finally {
    _endRequest();
  }
}`

const calendarUpcomingCode = `/// Upcoming Event Pre-fetching
Future<void> fetchUpcomingEvents() async {
  final now = DateTime.now().toUtc();
  final endTime = now.add(const Duration(hours: 24));

  final response = await Api.getCalendarEvents(
    type: 'upcoming',
    startTime: now.toIso8601String(),
    endTime: endTime.toIso8601String(),
  );

  // Store in local DB for quick access
  final events = (response['items'] as List?)
      ?.whereType<Map<String, dynamic>>()
      .toList() ?? [];

  for (final event in events) {
    await CalendarEventDb.upsert(event);
  }
}`

const eventLinkingCode = `/// Event-Conversation Linking
Future<void> linkEventToConversation(String conversationId) async {
  final listeningStartTime = DateTime.now();

  // Get events within time window
  final events = await CalendarEventDb.getEventsInRange(
    startTime: listeningStartTime.subtract(const Duration(minutes: 10)),
    endTime: listeningStartTime.add(const Duration(minutes: 10)),
  );

  // Filter by meeting guards
  final validEvents = events.where(_passesMeetingGuards).toList();

  if (validEvents.isEmpty) return;

  // Score by time proximity
  final scoredEvents = validEvents.map((event) {
    final eventStart = DateTime.parse(event['start']['dateTime']);
    final timeDiff = eventStart.difference(listeningStartTime).abs();
    return {'event': event, 'score': timeDiff.inMinutes};
  }).toList();

  scoredEvents.sort((a, b) => a['score'].compareTo(b['score']));

  // Link best match
  final bestMatch = scoredEvents.first['event'];
  await ConversationDb.updateEventId(conversationId, bestMatch['id']);

  // Store attendees
  final attendees = bestMatch['attendees'] as List?;
  if (attendees != null) {
    for (final attendee in attendees) {
      await AttendeeDb.upsert(conversationId, attendee);
    }
  }
}`

const meetingGuardCode = `/// Meeting Guard Pattern
bool _passesMeetingGuards(Map<String, dynamic> event) {
  // Guard 1: Must have meeting URL
  final hangoutLink = event['hangoutLink'];
  if (hangoutLink == null || hangoutLink.isEmpty) return false;

  // Guard 2: Must have attendees (at least 2)
  final attendees = event['attendees'] as List?;
  if (attendees == null || attendees.length < 2) return false;

  // Guard 3: Must not be cancelled
  final status = event['status'];
  if (status == 'cancelled') return false;

  // Guard 4: Must have valid time
  final start = event['start'];
  if (start == null || start['dateTime'] == null) return false;

  return true;
}`

const assignSpeakerCode = `/// [Intelligent Speaker Merging & Update Logic]
/// í™”ì ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë³‘í•©/ì¶©ëŒ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì²˜ë¦¬í•˜ê³ 
/// DBì˜ ë¬´ê²°ì„±ì„ ìœ ì§€í•˜ë©° ê´€ë ¨ ë°ì´í„°ë¥¼ ì¼ê´„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
Future<void> _updateExistingSpeaker(int spkrIdx, String newName) async {
  // 1. ì´ë©”ì¼/ì´ë¦„ìœ¼ë¡œ ê¸°ì¡´ í™”ì ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (ì¤‘ë³µ ì²´í¬)
  final existingAttendee = await AttendeeDb.findAttendeeByName(newName);
  if (existingAttendee != null) {
    // [Merge Case] ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í™”ìë¼ë©´ ë°ì´í„°ë¥¼ ë³‘í•©
    final targetSpkrIdx = existingAttendee['speakerIndex'];

    // 1. ê¸°ì¡´ í™”ìì˜ ë°œí™”(Transcript) ì†Œìœ ê¶Œì„ ìƒˆ í™”ìë¡œ ì´ì „
    await SpeakerDb.modifyTranscriptSpeaker(
      oldSpkrIdx: spkrIdx,
      newSpkrIdx: targetSpkrIdx
    );

    // 2. Attendee ë° Contact ì •ë³´ í†µí•©
    await AttendeeDb.mergeInfo(oldSpkrIdx, targetSpkrIdx);

    // 3. ì´ì „ í™”ì ë ˆì½”ë“œ ì‚­ì œ (Clean up)
    await SpeakerDb.deleteSpeaker(spkrIdx);
  } else {
    // [Update Case] ë‹¨ìˆœ ì •ë³´ ì—…ë°ì´íŠ¸
    await SpeakerDb.updateSpeaker(
      spkrIdx: spkrIdx,
      spkrName: newName,
      spkrState: 'confirmed'
    );

    // ëª¨ë“  ì°¸ì¡°ëœ í…ìŠ¤íŠ¸(ìš”ì•½, ë…¸íŠ¸ ë“±)ì—ì„œë„ ì´ë¦„ ë³€ê²½
    await _updateDataForAllReferences(oldName, newName);
  }
}

/// [Keyboard Navigation Handler]
/// ë¦¬ìŠ¤íŠ¸ íƒìƒ‰ê³¼ ë‹¨ì¶•í‚¤ ì„ íƒì„ ì²˜ë¦¬í•˜ì—¬ ë§ˆìš°ìŠ¤ ì—†ëŠ” ê²½í—˜ ì œê³µ
void _handleArrowKeys(KeyDownEvent event) {
  if (event.logicalKey == LogicalKeyboardKey.arrowDown) {
    // ë¦¬ìŠ¤íŠ¸ ìˆœí™˜ íƒìƒ‰ (ë§ˆì§€ë§‰ -> ì²˜ìŒ)
    int nextIndex = selectedIndex.value + 1;
    if (nextIndex >= displayList.length) nextIndex = 0;

    _selectItemByIndex(nextIndex);
    _scrollToSelectedIndex(); // ë·°í¬íŠ¸ ë™ê¸°í™”
  }
  // ... (ArrowUp, Enter, Cmd+Number ì²˜ë¦¬)
}`

const performanceMetrics = [
  { label: 'Image Loading Time', value: '0ms (Preloaded)' },
  { label: 'API Call Reduction', value: '80% (Incremental Sync)' },
  { label: 'Memory Efficiency', value: 'Smart Cache Cleanup' },
  { label: 'Keyboard Support', value: '100% Navigation' },
]

const techStacks = [
  {
    items: [
      'Flutter',
      'Dart',
      'GetX',
      'SQLite',
      'Native Plugins',
      'Google Calendar API',
      'WebSocket',
    ],
  },
]

const setupFeatureTextAnimation = (textRef) => {
  if (!textRef) return

  const modalOverlay = document.querySelector('.work-modal-overlay')
  if (!modalOverlay) return

  if (!textRef.offsetParent && textRef.offsetWidth === 0 && textRef.offsetHeight === 0) {
    return
  }

  try {
    gsap.set(textRef, {
      x: -100,
      opacity: 0,
    })

    const scrollTriggerConfig = {
      trigger: textRef,
      scroller: modalOverlay,
      start: 'top 80%',
      end: 'top 50%',
      toggleActions: 'play none none reverse',
      invalidateOnRefresh: true,
    }

    if (!scrollTriggerConfig.trigger || !scrollTriggerConfig.scroller) {
      return
    }

    gsap.to(textRef, {
      x: 0,
      opacity: 1,
      duration: 0.8,
      ease: 'power2.out',
      scrollTrigger: scrollTriggerConfig,
    })
  } catch (error) {
    console.warn('Feature text animation setup failed:', error)
  }
}

const setupFeatureCodeAnimation = (codeRef, textRef) => {
  if (!codeRef || !textRef) return

  const modalOverlay = document.querySelector('.work-modal-overlay')
  if (!modalOverlay) return

  if (!codeRef.offsetParent && codeRef.offsetWidth === 0 && codeRef.offsetHeight === 0) {
    return
  }

  try {
    gsap.set(codeRef, {
      x: 100,
      opacity: 0,
    })

    // Use the same trigger as the text to sync animations
    const scrollTriggerConfig = {
      trigger: textRef,
      scroller: modalOverlay,
      start: 'top 80%',
      end: 'top 50%',
      toggleActions: 'play none none reverse',
      invalidateOnRefresh: true,
    }

    if (!scrollTriggerConfig.trigger || !scrollTriggerConfig.scroller) {
      return
    }

    gsap.to(codeRef, {
      x: 0,
      opacity: 1,
      duration: 0.8,
      ease: 'power2.out',
      scrollTrigger: scrollTriggerConfig,
    })
  } catch (error) {
    console.warn('Feature code animation setup failed:', error)
  }
}

const setupFeatureBlockAnimation = (blockRef, index = 0) => {
  if (!blockRef) return

  const modalOverlay = document.querySelector('.work-modal-overlay')
  if (!modalOverlay) return

  if (!blockRef.offsetParent && blockRef.offsetWidth === 0 && blockRef.offsetHeight === 0) {
    return
  }

  try {
    gsap.set(blockRef, {
      y: 50,
      opacity: 0,
    })

    const scrollTriggerConfig = {
      trigger: blockRef,
      scroller: modalOverlay,
      start: 'top 90%',
      end: 'top 60%',
      toggleActions: 'play none none reverse',
      invalidateOnRefresh: true,
    }

    if (!scrollTriggerConfig.trigger || !scrollTriggerConfig.scroller) {
      return
    }

    gsap.to(blockRef, {
      y: 0,
      opacity: 1,
      duration: 0.8,
      ease: 'power2.out',
      delay: index * 0.1,
      scrollTrigger: scrollTriggerConfig,
    })
  } catch (error) {
    console.warn('Feature block animation setup failed:', error)
  }
}

const setupBlockAnimation = (block, index = 0) => {
  if (!block) return

  const modalOverlay = document.querySelector('.work-modal-overlay')
  if (!modalOverlay) return

  if (!block.offsetParent && block.offsetWidth === 0 && block.offsetHeight === 0) {
    return
  }

  try {
    gsap.set(block, {
      y: 50,
      opacity: 0,
    })

    const scrollTriggerConfig = {
      trigger: block,
      scroller: modalOverlay,
      start: 'top 90%',
      end: 'top 60%',
      toggleActions: 'play none none reverse',
      invalidateOnRefresh: true,
    }

    if (!scrollTriggerConfig.trigger || !scrollTriggerConfig.scroller) {
      return
    }

    gsap.to(block, {
      y: 0,
      opacity: 1,
      duration: 0.8,
      ease: 'power2.out',
      delay: index * 0.1,
      scrollTrigger: scrollTriggerConfig,
    })
  } catch (error) {
    console.warn('Block animation setup failed:', error)
  }
}

onMounted(() => {
  // Hero image scroll animation
  if (heroImageContainerRef.value && heroImageWrapperRef.value) {
    const modalOverlay = document.querySelector('.work-modal-overlay')

    if (modalOverlay && heroImageContainerRef.value) {
      try {
        const scrollTriggerConfig1 = {
          trigger: heroImageContainerRef.value,
          scroller: modalOverlay,
          start: 'top top',
          end: 'bottom center',
          scrub: 0.1,
        }

        if (scrollTriggerConfig1.trigger && scrollTriggerConfig1.scroller) {
          gsap.to(heroImageWrapperRef.value, {
            scale: isTablet.value ? (isMobile.value ? 0.7 : 0.7) : 0.9,
            bottom: isTablet.value ? (isMobile.value ? '-5%' : '0%') : '-8%',
            opacity: 1,
            scrollTrigger: scrollTriggerConfig1,
          })
        }

        const scrollTriggerConfig2 = {
          trigger: heroImageContainerRef.value,
          scroller: modalOverlay,
          start: 'top top',
          end: 'bottom center',
          scrub: 0.1,
        }

        if (scrollTriggerConfig2.trigger && scrollTriggerConfig2.scroller) {
          const isLandscape = window.innerWidth > window.innerHeight
          gsap.to(heroImageContainerRef.value, {
            marginTop: '100vh',
            height: isLandscape ? '' : '40vh',
            scrollTrigger: scrollTriggerConfig2,
          })
        }

        const scrollTriggerConfig3 = {
          trigger: heroImageContainerRef.value,
          scroller: modalOverlay,
          start: 'top 0px',
          end: '30px',
          scrub: 1,
        }

        if (scrollTriggerConfig3.trigger && scrollTriggerConfig3.scroller) {
          if (heroImageOverlayRef.value) {
            gsap.to(heroImageOverlayRef.value, {
              opacity: 0,
              scrollTrigger: scrollTriggerConfig3,
            })
          }

          if (workModalHeaderRef.value) {
            gsap.to(workModalHeaderRef.value, {
              opacity: 0,
              scrollTrigger: scrollTriggerConfig3,
            })
          }
        }
      } catch (error) {
        console.warn('Hero image animation setup failed:', error)
      }
    }
  }

  // Feature blocks animation (ì¹´ë“œ ì»¨í…Œì´ë„ˆ)
  nextTick(() => {
    nextTick(() => {
      const modalOverlay = document.querySelector('.work-modal-overlay')
      if (!modalOverlay) return

      const featureBlocks = [
        featureBlock1Ref.value,
        featureBlock2Ref.value,
        featureBlock3Ref.value,
        featureBlock4Ref.value,
        featureBlock5Ref.value,
        featureBlock6Ref.value,
        featureBlock7Ref.value,
      ]

      featureBlocks.forEach((blockRef, index) => {
        if (!blockRef) return

        if (blockRef.offsetParent === null) {
          setTimeout(() => {
            setupFeatureBlockAnimation(blockRef, index)
          }, 100)
          return
        }

        setupFeatureBlockAnimation(blockRef, index)
      })
    })
  })

  // Feature texts animation
  nextTick(() => {
    nextTick(() => {
      const modalOverlay = document.querySelector('.work-modal-overlay')
      if (!modalOverlay) return

      const featureTexts = [
        featureText1Ref.value,
        featureText2Ref.value,
        featureText3Ref.value,
        featureText4Ref.value,
        featureText5Ref.value,
        featureText6Ref.value,
        featureText7Ref.value,
      ]

      const featureCodes = [
        featureCode1Ref.value,
        featureCode2Ref.value,
        featureCode3Ref.value,
        featureCode4Ref.value,
        featureCode5Ref.value,
        featureCode6Ref.value,
        featureCode7Ref.value,
      ]

      featureTexts.forEach((textRef, index) => {
        if (!textRef) return

        const codeRef = featureCodes[index]

        if (textRef.offsetParent === null) {
          setTimeout(() => {
            setupFeatureTextAnimation(textRef)
            if (codeRef) {
              setupFeatureCodeAnimation(codeRef, textRef)
            }
          }, 100)
          return
        }

        setupFeatureTextAnimation(textRef)
        if (codeRef) {
          setupFeatureCodeAnimation(codeRef, textRef)
        }
      })
    })
  })

  // Blocks animation
  nextTick(() => {
    nextTick(() => {
      const modalOverlay = document.querySelector('.work-modal-overlay')
      if (!modalOverlay) return

      const blocks = document.querySelectorAll('.takeaway-block, .tech-stack-grid')

      blocks.forEach((block, index) => {
        if (
          !block ||
          (!block.offsetParent && block.offsetWidth === 0 && block.offsetHeight === 0)
        ) {
          setTimeout(
            () => {
              setupBlockAnimation(block, index)
            },
            100 + index * 50,
          )
          return
        }

        setupBlockAnimation(block, index)
      })
    })
  })
})
</script>

<style scoped>
@import '@/assets/styles/breakpoints.css';

.work-modal-content {
  width: 100%;
  min-height: 100vh;
  padding: 0px 0px;
  background-color: rgb(var(--gray--0));
}

.work-modal-header {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1000;
  width: 100%;
  height: auto;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.producthunt-badge {
  margin-top: 30px;
  z-index: 1000;
  display: flex;
  align-items: center;
  gap: 12px;
  pointer-events: none;
}

.producthunt-badge-icon {
  width: 48px;
  height: 48px;
  object-fit: contain;
}

.producthunt-badge-text {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.producthunt-badge-label {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--bold);
  color: rgb(var(--white--1));
  letter-spacing: -0.01em;
}

.producthunt-badge-date {
  font-size: var(--body--2--normal);
  font-weight: var(--font-weight--regular);
  color: rgb(var(--white--3));
}

.work-modal-title {
  font-size: var(--hero--1);
  font-weight: var(--font-weight--bold);
  color: rgb(var(--white--1));
  letter-spacing: -0.02em;
}

.work-modal-subtitle {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--regular);
  color: rgb(var(--white--3));
}

.work-modal-body {
  overflow: hidden;
}

.hero-image-container {
  position: relative;
  height: 100vh;
  overflow: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
}

.hero-image-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(var(--gray--0), 0.8);
  z-index: 3;
}

.hero-image-wrapper {
  position: relative;
  height: auto;
  transform: scale(4);
}

.hero-image {
  width: 100%;
  max-width: 1400px;
  height: auto;
  object-fit: contain;
  display: block;
  position: relative;
  z-index: 2;
}

/* Content Sections */
.content-section {
  max-width: 1200px;
  margin: 0 auto;
  padding: 60px 40px;
}

.section-title {
  font-size: var(--title--1);
  font-weight: var(--font-weight--bold);
  color: rgb(var(--white--1));
  margin: 0 0 30px 0;
  letter-spacing: -0.01em;
}

.section-text {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--regular);
  line-height: 1.7;
  color: rgb(var(--white--2));
}

.subsection-title {
  font-size: var(--title--3);
  font-weight: var(--font-weight--semibold);
  color: rgb(var(--white--1));
  margin: 0 0 16px 0;
}

/* Logo Evolution */
.logo-evolution {
  margin-top: 40px;
}

.logo-timeline {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-top: 30px;
  flex-wrap: wrap;
}

.logo-item {
  display: flex;
  width: 180px;
  height: 180px;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  flex: 0 0 auto;
  position: relative;
}

.logo-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 20px;
  background-color: rgb(var(--white--2));
  padding: 20px;
  transition: transform 0.3s ease;
  position: relative;
}

.logo-image:hover {
  transform: scale(1.05);
}

.logo-arrow {
  font-size: 2rem;
  color: rgb(var(--white--3));
  font-weight: var(--font-weight--bold);
  flex-shrink: 0;
  margin: 0 10px;
}

.logo-label {
  font-size: var(--body--2--normal);
  font-weight: var(--font-weight--medium);
  color: rgb(var(--white--2));
  text-align: center;
  margin: 0;
}

/* Feature Blocks */
.feature-block {
  margin-bottom: 80px;
  background-color: rgba(255, 255, 255, 0.02);
  border-radius: 24px;
  padding: 48px;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.feature-content {
  margin-bottom: 30px;
}

.feature-text {
  display: flex;
  flex-direction: column;
}

.feature-title {
  font-size: var(--title--2);
  font-weight: var(--font-weight--bold);
  color: rgb(var(--white--1));
  margin: 0 0 8px 0;
}

.feature-subtitle {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--regular);
  color: rgb(var(--white--3));
  margin: 0 0 30px 0;
}

.content-heading {
  font-size: var(--body--1--medium);
  font-weight: var(--font-weight--semibold);
  color: rgb(var(--white--1));
  margin: 24px 0 12px 0;
}

.content-text {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--regular);
  line-height: 1.7;
  color: rgb(var(--white--2));
  margin: 0 0 16px 0;
}

.solution-list {
  list-style: none;
  padding: 0;
  margin: 0 0 24px 0;
}

.solution-list li {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--regular);
  line-height: 1.7;
  color: rgb(var(--white--2));
  margin-bottom: 16px;
  padding-left: 24px;
  position: relative;
}

.solution-list li::before {
  content: 'â€¢';
  position: absolute;
  left: 0;
  color: rgb(var(--primary--green));
  font-weight: var(--font-weight--bold);
  font-size: 1.2em;
}

.feature-code-wrapper {
  width: 100%;
  margin-top: 30px;
}

/* Feature List */
.feature-list {
  list-style: none;
  padding: 0;
  margin: 0 0 15px 0;
}

.feature-list li {
  font-size: var(--body--1--normal);
  font-weight: var(--font-weight--regular);
  line-height: 1.7;
  color: rgb(var(--white--2));
  margin-bottom: 12px;
  padding-left: 24px;
  position: relative;
}

.feature-list li::before {
  content: 'â–¸';
  position: absolute;
  left: 0;
  color: rgb(var(--primary--green));
  font-weight: var(--font-weight--bold);
}

/* Takeaway Blocks */
.takeaway-block {
  margin-bottom: 40px;
  background-color: rgba(255, 255, 255, 0.02);
  border-radius: 24px;
  padding: 40px;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.takeaway-title {
  font-size: var(--body--1--medium);
  font-weight: var(--font-weight--bold);
  color: rgb(var(--white--1));
  margin: 0 0 16px 0;
}

/* Tablet: --tablet */
@media (--tablet) {
  .work-modal-title {
    font-size: var(--hero--2);
  }

  .content-section {
    padding: 40px 30px;
  }

  .section-title {
    font-size: var(--title--2);
  }

  .feature-block {
    margin-bottom: 60px;
  }

  .logo-timeline {
    gap: 15px;
  }

  .logo-image {
    max-width: 140px;
    padding: 15px;
  }

  .logo-arrow {
    font-size: 1.5rem;
    margin: 0 5px;
  }
}

/* Mobile: --mobile */
@media (--mobile) {
  .work-modal-title {
    font-size: var(--hero--3);
  }

  .work-modal-subtitle {
    font-size: var(--body--2--normal);
  }

  .content-section {
    padding: 30px 20px;
  }

  .section-title {
    font-size: var(--title--3);
  }

  .feature-block {
    margin-bottom: 40px;
  }

  .logo-timeline {
    gap: 10px;
  }

  .logo-image {
    max-width: 100px;
    padding: 12px;
  }

  .logo-arrow {
    font-size: 1.2rem;
    margin: 0 3px;
  }

  .logo-label {
    font-size: var(--caption--1);
  }

  .demo-gif {
    margin-top: 24px;
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  }
}

@media (--tablet) {
  .demo-gif {
    margin-top: 30px;
  }
}

@media (--desktop) {
  .demo-gif {
    margin-top: 40px;
  }
}
</style>
